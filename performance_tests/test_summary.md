# API性能测试结果摘要

## 测试时间
2026-01-16 18:06:20

## 测试环境
- API地址: http://localhost:3000
- 模拟ID: inference_1751611329_20221008
- 时间步: waterdepth_20221008_000000

---

## 1. REST API响应时间（P50/P95/P99）

### 1.1 健康检查端点 (`/api/health`)
- **测试请求数**: 100
- **P50 (中位数)**: 7ms
- **P95**: 9ms
- **P99**: 10ms
- **平均响应时间**: 7ms
- **最小响应时间**: 6ms
- **最大响应时间**: 10ms

**结论**: 健康检查端点性能优秀，响应时间稳定在10ms以内。

### 1.2 瓦片生成端点 - 缓存未命中 (`/api/tiles/.../14/{x}/{y}.png`)
- **测试请求数**: 10（不同瓦片坐标）
- **P50 (中位数)**: 16ms
- **P95**: 88ms
- **P99**: 88ms
- **平均响应时间**: 22ms
- **最小响应时间**: 15ms
- **最大响应时间**: 88ms

**结论**: 首次生成瓦片时，大部分请求在16ms左右完成，但有个别请求达到88ms（可能是首次加载或系统预热）。

### 1.3 瓦片生成端点 - 缓存命中
- **测试请求数**: 50（相同瓦片坐标）
- **P50 (中位数)**: 7ms
- **P95**: 8ms
- **P99**: 11ms
- **平均响应时间**: 7ms
- **最小响应时间**: 7ms
- **最大响应时间**: 11ms

**结论**: 缓存命中后，响应时间显著降低，与健康检查端点性能相当。

---

## 2. 缓存效果分析

### 缓存加速比
- **缓存未命中平均时间**: 22ms
- **缓存命中平均时间**: 7ms
- **加速比**: **3.14x**

**结论**: 缓存机制有效提升了性能，响应时间降低了约68%。

---

## 3. 性能评估

### 3.1 响应时间评估

| 端点类型 | P50 | P95 | P99 | 评估 |
|---------|-----|-----|-----|------|
| 健康检查 | 7ms | 9ms | 10ms | ✅ 优秀 |
| 瓦片生成（缓存命中） | 7ms | 8ms | 11ms | ✅ 优秀 |
| 瓦片生成（缓存未命中） | 16ms | 88ms | 88ms | ✅ 良好 |

### 3.2 性能目标对比

| 指标 | 目标 | 实际结果 | 状态 |
|------|------|----------|------|
| 健康检查 P95 | < 10ms | 9ms | ✅ 达标 |
| 瓦片生成（缓存）P95 | < 50ms | 8ms | ✅ 超标 |
| 瓦片生成（实时）P95 | < 500ms | 88ms | ✅ 超标 |

---

## 4. 关键发现

1. **缓存效果显著**: 缓存命中后响应时间从22ms降低到7ms，提升约3倍。

2. **响应时间稳定**: 健康检查和缓存命中的瓦片请求响应时间非常稳定，P99都在11ms以内。

3. **实时生成性能良好**: 即使缓存未命中，实时生成瓦片的平均响应时间也只有22ms，P95为88ms，远低于500ms的目标。

4. **系统性能优秀**: 所有测试端点的响应时间都达到了预期目标，部分指标远超预期。

---

## 5. 建议

1. **缓存策略优化**: 当前缓存效果良好，可以考虑：
   - 增加缓存大小（当前最大5000个瓦片）
   - 优化缓存淘汰策略

2. **性能监控**: 建议在生产环境中持续监控：
   - P95和P99响应时间
   - 缓存命中率
   - 系统资源使用情况

3. **负载测试**: 建议进行更高并发的测试，以确定系统的最大处理能力。

---

## 6. 后续测试建议

1. **吞吐量测试**: 测试系统在持续负载下的吞吐量（requests/sec）
2. **并发能力测试**: 测试不同并发级别下的性能表现
3. **不同缩放级别测试**: 测试z=13, 14, 15, 16的瓦片生成性能
4. **长时间稳定性测试**: 测试系统在长时间运行下的性能稳定性

---

**测试完成时间**: 2026-01-16 18:06:20  
**测试工具**: simple_performance_test.sh  
**报告生成**: 自动生成
